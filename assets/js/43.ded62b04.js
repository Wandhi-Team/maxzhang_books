(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{366:function(e,a,t){"use strict";t.r(a);var s=t(3),v=Object(s.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"memcache-php-使用笔记"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#memcache-php-使用笔记"}},[e._v("#")]),e._v(" Memcache PHP 使用笔记")]),e._v(" "),a("p",[e._v("最近在做网站迁移")]),e._v(" "),a("p",[e._v("看到之前的一个网站目录下Cache文件里上万的缓存文件真是害怕")]),e._v(" "),a("p",[e._v("新的服务器上配置了memcache扩展")]),e._v(" "),a("p",[e._v("于是乎准备折腾一下看看能不能把之前的文件缓存升级为Memcache")]),e._v(" "),a("p",[e._v("查了下Memcache的相关文档")]),e._v(" "),a("p",[e._v("这里我们用到3个主要函数")]),e._v(" "),a("h3",{attrs:{id:"connect-host-port"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#connect-host-port"}},[e._v("#")]),e._v(" Connect(host,port)")]),e._v(" "),a("p",[e._v("Memcache的服务端连接函数")]),e._v(" "),a("p",[e._v("第一个参数是Memcache服务器地址")]),e._v(" "),a("p",[e._v("第二参数是Memcache的端口号（为Memcache服务默认监听端口）")]),e._v(" "),a("p",[e._v("会返回一个bool值来告诉你是否连接成功")]),e._v(" "),a("p",[e._v("例")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$mem = new Memcache;  \n$mem->connect("127.0.0.1", 11211);//11211为Memcache服务默认监听端口\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h3",{attrs:{id:"set-key-value-type-time"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-key-value-type-time"}},[e._v("#")]),e._v(" Set(key,value,type,time)")]),e._v(" "),a("p",[e._v("保存一个数据到Memcache服务器上")]),e._v(" "),a("p",[e._v("第一个参数是数据的key，用来定位一个数据（索引）")]),e._v(" "),a("p",[e._v("第二个参数是需要保存的数据内容，这里是一个字符串")]),e._v(" "),a("p",[e._v("第三个参数是一个标记，一般设置为0或者MEMCACHE_COMPRESSED（压缩）")]),e._v(" "),a("p",[e._v("第四个参数是数据的有效期，单位是秒，如果设置为0，则是永远有效")]),e._v(" "),a("p",[e._v("例")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$mem = new Memcache;  \n$mem->connect("127.0.0.1", 11211);\n$mem->set(md5($key), $value, 0, $expire);\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[e._v("这里为了去重我把键名用md5加密了一遍")]),e._v(" "),a("p",[e._v("还有一个add跟replace方法就不在介绍了")]),e._v(" "),a("h3",{attrs:{id:"get-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#get-key"}},[e._v("#")]),e._v(" Get(key)")]),e._v(" "),a("p",[e._v("从Memcache服务器端获取一条数据")]),e._v(" "),a("p",[e._v("它只有一个参数，就是需要获取数据的key\n例")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$mem = new Memcache;  \n$mem->connect("127.0.0.1", 11211);\n$mem->set(md5($key), $value, 0, $expire);\n$val = $mem->get(md5($key));\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br")])]),a("p",[e._v("然后我们就可以拿着这个值为所欲为了")]),e._v(" "),a("p",[e._v("另外在介绍两个函数，我是不常用")]),e._v(" "),a("p",[e._v("delete(key)")]),e._v(" "),a("p",[e._v("删除指定的数据")]),e._v(" "),a("p",[e._v("flush();")]),e._v(" "),a("p",[e._v("清空Memcache服务器内的所以数据")])])}),[],!1,null,null,null);a.default=v.exports}}]);