(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{524:function(s,a,n){"use strict";n.r(a);var t=n(22),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("闲来无事")]),s._v(" "),n("p",[s._v("学点新知识")]),s._v(" "),n("p",[s._v("之前就看过Task见过类似的用法")]),s._v(" "),n("p",[s._v("就是没有特意的去了解这个类")]),s._v(" "),n("p",[s._v("今天来了解下顺便记个笔记、、、")]),s._v(" "),n("h2",{attrs:{id:"本质"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#本质"}},[s._v("#")]),s._v(" 本质")]),s._v(" "),n("p",[s._v("Task是一个类，它是基于任务的异步模式而产生的")]),s._v(" "),n("p",[s._v("首次引入在Framework 4中")]),s._v(" "),n("p",[s._v("看到这里你一定会想到多线程Thread与线程池ThreadPool")]),s._v(" "),n("p",[s._v("而Task跟线程池的功能是很相似的")]),s._v(" "),n("p",[s._v("当我们用Task开启新任务的时候，系统会从线程池中调用线程")]),s._v(" "),n("p",[s._v("而Thread会在每次实例化的时候创建一个新的线程")]),s._v(" "),n("blockquote",[n("p",[s._v("如果你需要一个长时间的操作，请使用Task（Acton，TaskCreationOptions）构造函数中的\nTaskCreationOptions.LongRunning,暗示任务调度器，将这个线程放在非线程池上执行")])]),s._v(" "),n("h2",{attrs:{id:"task的启动方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#task的启动方式"}},[s._v("#")]),s._v(" Task的启动方式")]),s._v(" "),n("h3",{attrs:{id:"start"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#start"}},[s._v("#")]),s._v(" Start")]),s._v(" "),n("p",[s._v("New Task(Action)")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('class Program\n   {\n       static void Main(string[] args)\n       {\n           Task t = new Task(DoA);\n           t.Start();\n           Console.ReadKey();\n       }\n       static void DoA()\n       {\n           for (int i = 0; i < 100; i++)\n           {\n               Console.WriteLine("i={0}\\n", i);\n           }\n       }\n   }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("h3",{attrs:{id:"run"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" Run")]),s._v(" "),n("p",[s._v("Task.Run(Action)")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('static void Main(string[] args)\n       {\n           Task.Run(() =>\n           {\n               for (int i = 0; i < 50; i++)\n               {\n                   Console.WriteLine("i={0}",i);\n               }\n           });\n           Console.ReadKey();\n       }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h3",{attrs:{id:"具有返回值的task"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#具有返回值的task"}},[s._v("#")]),s._v(" 具有返回值的Task")]),s._v(" "),n("p",[s._v("Task.Run"),n("T",[s._v("(Action)")])],1),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('Task<int> task = Task.Run<int>(() =>\n         {\n             int sum = 0;\n             for (int i = 0; i < 50; i++)\n             {\n                 sum += 1;\n             }\n             return sum;\n         });\n         int result = task.Result;\n         Console.WriteLine("运算结果是：{0}",result);//输出50\n         Console.ReadKey();\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"factory"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#factory"}},[s._v("#")]),s._v(" Factory")]),s._v(" "),n("p",[s._v("Task.Factory.StartNew(Action)")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('Task t = Task.Factory.StartNew(() =>\n            {\n                for (int i = 0; i < 10; i++)\n                {\n                    Console.WriteLine("i={0}", i);\n                }\n            });\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"task中的wait"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#task中的wait"}},[s._v("#")]),s._v(" Task中的wait")]),s._v(" "),n("h3",{attrs:{id:"基本用法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基本用法"}},[s._v("#")]),s._v(" 基本用法")]),s._v(" "),n("p",[s._v("默认情况下，Task 是有线程池中的异步线程执行")]),s._v(" "),n("p",[s._v("是否执行完成，可以通过Task的的属性IsCompleted 来判断")]),s._v(" "),n("p",[s._v("如果想在子线程工作完成之后，在进行后续主线程工作可以通过调用task.Wait() 来等待线程完成")]),s._v(" "),n("p",[s._v("调用Wait后，当前线程会被阻塞，直到到子线程完成")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('static void Main(string[] args)\n       {\n           Task t = Task.Run(() =>\n             {\n                 Thread.Sleep(500);\n                 Console.WriteLine("Lance");\n                 Thread.Sleep(500);\n             });\n           Console.WriteLine("t.IsCompleted=" + t.IsCompleted);\n           t.Wait();\n           Console.WriteLine("t.IsCompleted=" + t.IsCompleted);\n       }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("运行结果：")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://images2015.cnblogs.com/blog/32909/201706/32909-20170610145920387-990719828.png",alt:"image"}})]),s._v(" "),n("h3",{attrs:{id:"具有等待时间的wait"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#具有等待时间的wait"}},[s._v("#")]),s._v(" 具有等待时间的Wait")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('static void Main(string[] args)\n       {\n           Task t = Task.Run(() =>\n             {\n                 Thread.Sleep(500);\n                 Console.WriteLine("Lance");\n                 Thread.Sleep(500);\n             });\n           Console.WriteLine("t.IsCompleted=" + t.IsCompleted);\n           bool IsComplate= t.Wait(200);\n           Console.WriteLine("wait 200毫秒后 t.IsCompleted=" + t.IsCompleted);\n           Thread.Sleep(1000);\n           Console.WriteLine("t.IsCompleted=" + t.IsCompleted);\n       }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br")])]),n("p",[s._v("运行结果：")]),s._v(" "),n("p",[n("img",{attrs:{src:"http://images2015.cnblogs.com/blog/32909/201706/32909-20170610150225387-943498666.png",alt:"image"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);