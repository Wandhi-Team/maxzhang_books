(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{370:function(s,e,a){"use strict";a.r(e);var t=a(4),r=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("blockquote",[e("p",[s._v("原文 https://github.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY")])]),s._v(" "),e("h2",{attrs:{id:"proxmox-ve-7-x-相关教程"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-7-x-相关教程"}},[s._v("#")]),s._v(" Proxmox VE 7.x 相关教程")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("包括但不限于换源、直通、界面显示温度/频率等。")])])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-7-x-换源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-7-x-换源"}},[s._v("#")]),s._v(" Proxmox VE 7.x 换源")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("必须保证pve系统能联网，没联网，没法换源。")])])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"ssh登录到pve后台-然后一条一条的执行命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ssh登录到pve后台-然后一条一条的执行命令"}},[s._v("#")]),s._v(" SSH登录到pve后台，然后一条一条的执行命令")]),s._v(" "),e("h4",{attrs:{id:"_1-处理掉企业源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-处理掉企业源"}},[s._v("#")]),s._v(" 1.处理掉企业源")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("rm -rf /etc/apt/sources.list.d/pve-install-repo.list\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "#deb https://enterprise.proxmox.com/debian/pve Bullseye pve-enterprise" > /etc/apt/sources.list.d/pve-enterprise.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-开始换源"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-开始换源"}},[s._v("#")]),s._v(" 2.开始换源")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("wget https://mirrors.ustc.edu.cn/proxmox/debian/proxmox-release-bullseye.gpg -O /etc/apt/trusted.gpg.d/proxmox-release-bullseye.gpg\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "deb https://mirrors.ustc.edu.cn/proxmox/debian/pve bullseye pve-no-subscription" > /etc/apt/sources.list.d/pve-no-subscription.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "deb https://mirrors.ustc.edu.cn/proxmox/debian/ceph-pacific bullseye main" > /etc/apt/sources.list.d/ceph.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('sed -i.bak "s#http://download.proxmox.com/debian#https://mirrors.ustc.edu.cn/proxmox/debian#g" /usr/share/perl5/PVE/CLI/pveceph.pm\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('sed -i.bak "s#ftp.debian.org/debian#mirrors.aliyun.com/debian#g" /etc/apt/sources.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('sed -i "s#security.debian.org#mirrors.aliyun.com/debian-security#g" /etc/apt/sources.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "deb http://download.proxmox.com/debian/pve bullseye pve-no-subscription" >>  /etc/apt/sources.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3-最后更新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-最后更新"}},[s._v("#")]),s._v(" 3.最后更新")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt update && apt dist-upgrade -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-7-x-关订阅提示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-7-x-关订阅提示"}},[s._v("#")]),s._v(" Proxmox VE 7.x 关订阅提示")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-winscp登录到pve-编辑打开这个文件-usr-share-javascript-proxmox-widget-toolkit-proxmoxlib-js-防止手贱-建议备份"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-winscp登录到pve-编辑打开这个文件-usr-share-javascript-proxmox-widget-toolkit-proxmoxlib-js-防止手贱-建议备份"}},[s._v("#")]),s._v(" 1.WinSCP登录到PVE，编辑打开这个文件：/usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js (防止手贱，建议备份)")]),s._v(" "),e("h4",{attrs:{id:"_2-搜索-data-status-tolowercase-找到这一段"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-搜索-data-status-tolowercase-找到这一段"}},[s._v("#")]),s._v(" 2.搜索 data.status.toLowerCase，找到这一段：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/01.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-直接删掉红框内容-变成如下图-最后保存即可。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-直接删掉红框内容-变成如下图-最后保存即可。"}},[s._v("#")]),s._v(" 3.直接删掉红框内容，变成如下图，最后保存即可。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/02.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("如果更新到PVE 7.1-5或者更新，发现改了上面的没效果，那么就要多改一步：")])]),s._v(" "),e("li",[e("p",[s._v("继续搜索 data.status.toLowerCase，找到这一段：")])])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/03.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("直接删掉红框内容，变成如下图，最后保存即可")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/04.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_4-改完保存-重进pve界面刷新-去更新点击刷新-就没订阅提示了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-改完保存-重进pve界面刷新-去更新点击刷新-就没订阅提示了。"}},[s._v("#")]),s._v(" 4.改完保存，重进PVE界面刷新，去更新点击刷新，就没订阅提示了。")])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-主界面显示cpu温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-主界面显示cpu温度"}},[s._v("#")]),s._v(" Proxmox VE 主界面显示CPU温度")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-登录pve的ssh-执行命令安装sensors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录pve的ssh-执行命令安装sensors"}},[s._v("#")]),s._v(" 1.登录PVE的SSH，执行命令安装sensors：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt-get install lm-sensors\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-探测下温度-执行-sensors-detect-一路yes-回车"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-探测下温度-执行-sensors-detect-一路yes-回车"}},[s._v("#")]),s._v(" 2.探测下温度，执行："),e("code",[s._v("sensors-detect")]),s._v(" (一路yes，回车)")]),s._v(" "),e("h4",{attrs:{id:"_3-获取温度信息-执行-sensors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-获取温度信息-执行-sensors"}},[s._v("#")]),s._v(" 3.获取温度信息，执行："),e("code",[s._v("sensors")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/1.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("红色箭头：temp1这里是主板温度，可能某些主板还有temp2、temp3等")])]),s._v(" "),e("li",[e("p",[s._v("黄色箭头：Package id 0、core0~5这里是CPU温度，有多少个核心，就显示多少")])])]),s._v(" "),e("h4",{attrs:{id:"_4-winscp登录到pve-修改这个文件-usr-share-perl5-pve-api2-nodes-pm"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-winscp登录到pve-修改这个文件-usr-share-perl5-pve-api2-nodes-pm"}},[s._v("#")]),s._v(" 4.WinSCP登录到PVE，修改这个文件：/usr/share/perl5/PVE/API2/Nodes.pm")]),s._v(" "),e("p",[s._v("(我习惯于下载到本地用Notepad++修改)")]),s._v(" "),e("p",[s._v("搜索："),e("code",[s._v("$res->{pveversion} = PVE::pvecfg::package()")])]),s._v(" "),e("p",[s._v("在这个定义的下方添加："),e("code",[s._v("$res->{thermalstate} = `sensors`;")])]),s._v(" "),e("p",[s._v("结果如图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/2.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("修改完保存，然后塞回路径。")]),s._v(" "),e("h4",{attrs:{id:"_5-修改这个文件-usr-share-pve-manager-js-pvemanagerlib-js-建议备份-万一自己改炸就不好了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-修改这个文件-usr-share-pve-manager-js-pvemanagerlib-js-建议备份-万一自己改炸就不好了。"}},[s._v("#")]),s._v(" 5.修改这个文件：/usr/share/pve-manager/js/pvemanagerlib.js (建议备份，万一自己改炸就不好了。)")]),s._v(" "),e("p",[s._v("(我习惯于下载到本地用Notepad++修改)")]),s._v(" "),e("p",[s._v("搜索"),e("code",[s._v("PVE Manager Version")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/3.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("在这个定义的下方添加一个定义：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    {\n          itemId: 'thermal',\n          colspan: 2,\n          printBar: false,\n          title: gettext('温度'),\n          textField: 'thermalstate',\n          renderer:function(value){\n              const p0 = value.match(/Package id 0.*?\\+([\\d\\.]+)Â/)[1];\n              const b0 = value.match(/temp1.*?\\+([\\d\\.]+)?/)[1];\n              return `CPU: ${p0} ℃ || 主板: ${b0} ℃ `\n            }\n    },\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("结果如图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/4.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("上述是一种比较简单的万金油做法，有些人可能要把每个核心的温度有写出来，或者说有几个主板温度，也要一起写出来，那么就按照下列的格式：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("    {\n          itemId: 'thermal',\n          colspan: 2,\n          printBar: false,\n          title: gettext('温度'),\n          textField: 'thermalstate',\n          renderer:function(value){\n              const p0 = value.match(/Package id 0.*?\\+([\\d\\.]+)Â/)[1];\n              const c0 = value.match(/Core 0.*?\\+([\\d\\.]+)Â/)[1];\n              const c1 = value.match(/Core 1.*?\\+([\\d\\.]+)Â/)[1];\n              const c2 = value.match(/Core 2.*?\\+([\\d\\.]+)Â/)[1];\n              const c3 = value.match(/Core 3.*?\\+([\\d\\.]+)Â/)[1];\n              const c4 = value.match(/Core 4.*?\\+([\\d\\.]+)Â/)[1];\n              const c5 = value.match(/Core 5.*?\\+([\\d\\.]+)Â/)[1];\n              const b0 = value.match(/temp1.*?\\+([\\d\\.]+)?/)[1];\n              const b1 = value.match(/temp2.*?\\+([\\d\\.]+)?/)[1];\n              return `CPU: ${p0} ℃ || CPU1: ${c0} ℃ CPU2: ${c1} ℃ CPU3: ${c2} ℃ CPU4: ${c3} ℃ CPU5: ${c4} ℃ CPU6: ${c5} ℃ || 主板1: ${b0} ℃ 主板2: ${b1} ℃`\n            }\n    },\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("p",[s._v("结果如图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/5.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("红框内就是单独每个核心或者每个主板温度")])]),s._v(" "),e("li",[e("p",[s._v("前面的CPU温度是综合温度，后面的CPU1~6是每个核心单独温度")])]),s._v(" "),e("li",[e("p",[s._v("可根据实际情况增减CPU温度或者主板温度")])]),s._v(" "),e("li",[e("p",[s._v("其实如果核心超过4个，不建议把每个核心温度写出来，不美观")])])]),s._v(" "),e("h4",{attrs:{id:"_6-改完执行-systemctl-restart-pveproxy-重进pve主页-就看到温度显示了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-改完执行-systemctl-restart-pveproxy-重进pve主页-就看到温度显示了。"}},[s._v("#")]),s._v(" 6.改完执行 "),e("code",[s._v("systemctl restart pveproxy")]),s._v(" 重进PVE主页，就看到温度显示了。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/6.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-主界面显示-pci-e盘位-硬盘温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-主界面显示-pci-e盘位-硬盘温度"}},[s._v("#")]),s._v(" Proxmox VE 主界面显示(PCI-E盘位)硬盘温度")]),s._v(" "),e("p",[e("strong",[s._v("承接上一个显示CPU温度教程。")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("此教程主要针对PCI-E盘位硬盘(也就是M.2固态)，SATA盘位硬盘显示温度教程在下方。")])]),s._v(" "),e("li",[e("p",[s._v("此教程是在上个“Proxmox VE 主界面显示CPU温度”基础上来做。")])])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"扩展下-主界面添加m-2固态硬盘温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#扩展下-主界面添加m-2固态硬盘温度"}},[s._v("#")]),s._v(" * 扩展下，主界面添加M.2固态硬盘温度：")]),s._v(" "),e("h4",{attrs:{id:"_1-已经完成-proxmox-ve-主界面显示cpu温度-然后终端执行-sensors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-已经完成-proxmox-ve-主界面显示cpu温度-然后终端执行-sensors"}},[s._v("#")]),s._v(" 1.已经完成“Proxmox VE 主界面显示CPU温度”，然后终端执行："),e("code",[s._v("sensors")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/34.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("nvme-pci-0100此处就是M.2固态温度")])]),s._v(" "),e("h4",{attrs:{id:"_2-修改这个文件-usr-share-pve-manager-js-pvemanagerlib-js"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改这个文件-usr-share-pve-manager-js-pvemanagerlib-js"}},[s._v("#")]),s._v(" 2.修改这个文件：/usr/share/pve-manager/js/pvemanagerlib.js")]),s._v(" "),e("p",[s._v("在上个教程改CPU温度的定义里，加入下图红框内的内容：")]),s._v(" "),e("p",[e("code",[s._v("const nvme0 = value.match(/Composite.*?\\+([\\d\\.]+)Â/)[1];")])]),s._v(" "),e("p",[e("code",[s._v("|| 固态: ${nvme0} ℃")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/35.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-改完保存执行systemctl-restart-pveproxy重进pve主页。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-改完保存执行systemctl-restart-pveproxy重进pve主页。"}},[s._v("#")]),s._v(" 3.改完保存执行"),e("code",[s._v("systemctl restart pveproxy")]),s._v("重进PVE主页。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/36.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-主界面显示cpu频率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-主界面显示cpu频率"}},[s._v("#")]),s._v(" Proxmox VE 主界面显示CPU频率")]),s._v(" "),e("p",[e("strong",[s._v("承接上一个显示CPU温度教程。")])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"扩展下-主界面添加cpu频率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#扩展下-主界面添加cpu频率"}},[s._v("#")]),s._v(" * 扩展下，主界面添加CPU频率：")]),s._v(" "),e("h4",{attrs:{id:"_1-也是修改-usr-share-perl5-pve-api2-nodes-pm-和-usr-share-pve-manager-js-pvemanagerlib-js-这2个文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-也是修改-usr-share-perl5-pve-api2-nodes-pm-和-usr-share-pve-manager-js-pvemanagerlib-js-这2个文件"}},[s._v("#")]),s._v(" 1.也是修改 /usr/share/perl5/PVE/API2/Nodes.pm 和 /usr/share/pve-manager/js/pvemanagerlib.js 这2个文件")]),s._v(" "),e("ul",[e("li",[s._v("/usr/share/perl5/PVE/API2/Nodes.pm 刚刚修改CPU温度那里添加：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("$res->{cpusensors} = `lscpu | grep MHz`;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/25.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("/usr/share/pve-manager/js/pvemanagerlib.js 刚刚修改温度的下一行添加：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\t{\n          itemId: 'MHz',\n          colspan: 2,\n          printBar: false,\n          title: gettext('CPU频率'),\n          textField: 'cpusensors',\n          renderer:function(value){\n\t\t\t  const f0 = value.match(/CPU MHz.*?([\\d]+)/)[1];\n\t\t\t  const f1 = value.match(/CPU min MHz.*?([\\d]+)/)[1];\n\t\t\t  const f2 = value.match(/CPU max MHz.*?([\\d]+)/)[1];\n\t\t\t  return `实时: ${f0} MHz | 最小: ${f1} MHz | 最大: ${f2} MHz `\n            }\n\t},\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/26.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_2-改完执行-systemctl-restart-pveproxy-重进pve主页-效果如图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-改完执行-systemctl-restart-pveproxy-重进pve主页-效果如图"}},[s._v("#")]),s._v(" 2.改完执行 "),e("code",[s._v("systemctl restart pveproxy")]),s._v(" 重进PVE主页，效果如图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/27.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-主界面显示-sata盘位-硬盘温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-主界面显示-sata盘位-硬盘温度"}},[s._v("#")]),s._v(" Proxmox VE 主界面显示(SATA盘位)硬盘温度")]),s._v(" "),e("p",[e("strong",[s._v("同样承接上一个显示CPU温度教程。")])]),s._v(" "),e("ul",[e("li",[s._v("此教程主要针对SATA盘位硬盘。")])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"扩展下-主界面添加硬盘温度"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#扩展下-主界面添加硬盘温度"}},[s._v("#")]),s._v(" * 扩展下，主界面添加硬盘温度：")]),s._v(" "),e("h4",{attrs:{id:"_1-登录pve的ssh-执行命令安装hddtemp"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录pve的ssh-执行命令安装hddtemp"}},[s._v("#")]),s._v(" 1.登录PVE的SSH，执行命令安装hddtemp：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt-get install hddtemp\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("然后执行 "),e("code",[s._v("chmod +s /usr/sbin/hddtemp")])])]),s._v(" "),e("li",[e("p",[s._v("执行 "),e("code",[s._v("hddtemp /dev/sd?")]),s._v(" 就能看到硬盘温度：")])])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/33.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_2-然后修改-usr-share-perl5-pve-api2-nodes-pm-和-usr-share-pve-manager-js-pvemanagerlib-js-这2个文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-然后修改-usr-share-perl5-pve-api2-nodes-pm-和-usr-share-pve-manager-js-pvemanagerlib-js-这2个文件"}},[s._v("#")]),s._v(" 2.然后修改 /usr/share/perl5/PVE/API2/Nodes.pm 和 /usr/share/pve-manager/js/pvemanagerlib.js 这2个文件")]),s._v(" "),e("ul",[e("li",[s._v("/usr/share/perl5/PVE/API2/Nodes.pm 刚刚修改CPU温度那里添加：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(" $res->{thermal_hdd} = `hddtemp /dev/sd?`;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/30.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("/usr/share/pve-manager/js/pvemanagerlib.js 刚刚修改CPU温度的下一行添加：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\t{\n            itemId: 'thermal-hdd',\n            colspan: 2,\n            printBar: false,\n            title: gettext('硬盘温度'),\n            textField: 'thermal_hdd',\n            renderer: function(value) {\n                value = value.replaceAll('Â', '');\n                return value.replaceAll('\\n', '<br>');\n            }\n\t},\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/31.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-改完执行-systemctl-restart-pveproxy-重进pve主页-效果如图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-改完执行-systemctl-restart-pveproxy-重进pve主页-效果如图"}},[s._v("#")]),s._v(" 3.改完执行 "),e("code",[s._v("systemctl restart pveproxy")]),s._v(" 重进PVE主页，效果如图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/32.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-主界面显示温度的另一种方案-json格式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-主界面显示温度的另一种方案-json格式"}},[s._v("#")]),s._v(" Proxmox VE 主界面显示温度的另一种方案: JSON格式")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("因为常规的方案有些局限，但是吧，我又不想推翻整个“温度”相关的教程，所以单独说下。")])]),s._v(" "),e("li",[e("p",[s._v("自己本身没插nvme固态，所以呢，我就以普通的CPU温度为例，道理是一样的。")])]),s._v(" "),e("li",[e("p",[s._v("适合多个nvme固态等同参数的获取温度，如果不懂是啥，此教程就忽略。")])])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"比如多个nvme固态显示温度-看如下图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#比如多个nvme固态显示温度-看如下图"}},[s._v("#")]),s._v(" * 比如多个nvme固态显示温度，看如下图：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/44.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("可以看到两块nvme固态的温度读取值都是Composite，但是确实有2个固态，用之前常规的方案，就无法显示2个nvme固态的温度，所以需要另外的方案。")]),s._v(" "),e("h4",{attrs:{id:"_1-常理还是必须安装sensors"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-常理还是必须安装sensors"}},[s._v("#")]),s._v(" 1.常理还是必须安装sensors：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt-get install lm-sensors\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-然后终端执行sensors-j"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-然后终端执行sensors-j"}},[s._v("#")]),s._v(" 2.然后终端执行"),e("code",[s._v("sensors -j")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/45.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("coretemp-isa-0000 CPU传感器")]),s._v(" "),e("p",[s._v("temp1_input/temp2_input/temp3_input等就是核心温度")]),s._v(" "),e("h4",{attrs:{id:"_3-也是修改-usr-share-perl5-pve-api2-nodes-pm-同样的位置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-也是修改-usr-share-perl5-pve-api2-nodes-pm-同样的位置"}},[s._v("#")]),s._v(" 3.也是修改：/usr/share/perl5/PVE/API2/Nodes.pm 同样的位置：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("$res->{sensinfo} = `sensors -j`;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/46.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_4-也是修改这个文件-usr-share-pve-manager-js-pvemanagerlib-js-同样的位置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-也是修改这个文件-usr-share-pve-manager-js-pvemanagerlib-js-同样的位置"}},[s._v("#")]),s._v(" 4.也是修改这个文件：/usr/share/pve-manager/js/pvemanagerlib.js 同样的位置：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\t{\n          itemId: 'sensinfo',\n          colspan: 2,\n          printBar: false,\n          title: gettext('温度'),\n          textField: 'sensinfo',\n          renderer:function(value){\n\t\t\t  value = JSON.parse(value.replaceAll('Â', ''));\n\t\t\t  const c0 = value['coretemp-isa-0000']['Core 0']['temp2_input'].toFixed(1);\n\t\t\t  const c1 = value['coretemp-isa-0000']['Core 1']['temp3_input'].toFixed(1);\n\t\t\t  const c2 = value['coretemp-isa-0000']['Core 2']['temp4_input'].toFixed(1);\n\t\t\t  const c3 = value['coretemp-isa-0000']['Core 3']['temp5_input'].toFixed(1);\t\t\t  \n\t\t\t  return `CPU温度: ${c0}℃ | ${c1}℃ | ${c2}℃ | ${c3}℃ `; \n            }\n    },\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/47.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("coretemp-isa-0000 CPU传感器")])]),s._v(" "),e("li",[e("p",[s._v("Core 0 到 Core 3 就是CPU核心1~4")])]),s._v(" "),e("li",[e("p",[s._v("temp2_input 到 temp5_input CPU核心1~4的温度")])]),s._v(" "),e("li",[e("p",[s._v("如果有别的传感器温度，比如nvme固态，依葫芦画瓢更改内容。")])])]),s._v(" "),e("h4",{attrs:{id:"_5-如果用这种方案改写了cpu温度-之前的常规cpu方案代码可以去掉-自行理解-这个教程我写的比较简单。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-如果用这种方案改写了cpu温度-之前的常规cpu方案代码可以去掉-自行理解-这个教程我写的比较简单。"}},[s._v("#")]),s._v(" 5.如果用这种方案改写了CPU温度，之前的常规CPU方案代码可以去掉，自行理解，这个教程我写的比较简单。")]),s._v(" "),e("h4",{attrs:{id:"_6-改完保存执行systemctl-restart-pveproxy重进pve主页。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-改完保存执行systemctl-restart-pveproxy重进pve主页。"}},[s._v("#")]),s._v(" 6.改完保存执行"),e("code",[s._v("systemctl restart pveproxy")]),s._v("重进PVE主页。")])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"proxmox-ve-改显示范围"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxmox-ve-改显示范围"}},[s._v("#")]),s._v(" Proxmox VE 改显示范围")]),s._v(" "),e("p",[e("strong",[s._v("如果发现改上面的温度/CPU频率/硬盘温度，步骤又没错，但是主界面不显示，就需要下列教程。")])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"改布局"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#改布局"}},[s._v("#")]),s._v(" 改布局：")]),s._v(" "),e("ul",[e("li",[s._v("还是这个文件：pvemanagerlib.js，搜索："),e("code",[s._v("widget.pveNodeStatus")])])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/29.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("将 height: 300 改大为400，或者更大，然后保存。")]),s._v(" "),e("ul",[e("li",[s._v("搜索："),e("code",[s._v("gettext('Status') + ': ' + zpool")]),s._v(" (这一处不一定有，搜不到，就不用管了。)")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/28.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("将 height: 600 改大为700，或者更大，然后保存。")])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"核显直通-intel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#核显直通-intel"}},[s._v("#")]),s._v(" 核显直通(intel)")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-编辑grub配置文件-etc-default-grub"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-编辑grub配置文件-etc-default-grub"}},[s._v("#")]),s._v(" 1.编辑GRUB配置文件：/etc/default/grub")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('sed -i "s/quiet/quiet intel_iommu=on iommu=pt video=efifb:off,vesafb:off/g" /etc/default/grub\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("改好结果：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/7.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("然后执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("update-grub\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-添加所需的系统模块-驱动-etc-modules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加所需的系统模块-驱动-etc-modules"}},[s._v("#")]),s._v(" 2.添加所需的系统模块(驱动)：/etc/modules")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "vfio" >> /etc/modules\n\necho "vfio_iommu_type1" >> /etc/modules\n\necho "vfio_pci" >> /etc/modules\n\necho "vfio_virqfd" >> /etc/modules\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("改好结果：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/8.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("h4",{attrs:{id:"pve7-x-直接跳过3、4、5-直接到第6步即可-pve6-x就一步步看。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pve7-x-直接跳过3、4、5-直接到第6步即可-pve6-x就一步步看。"}},[s._v("#")]),s._v(" PVE7.x 直接跳过3、4、5，直接到第6步即可；PVE6.x就一步步看。")])])]),s._v(" "),e("h4",{attrs:{id:"_3-添加模块-驱动-黑名单-etc-modprobe-d-pve-blacklist-conf"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加模块-驱动-黑名单-etc-modprobe-d-pve-blacklist-conf"}},[s._v("#")]),s._v(" 3.添加模块(驱动)黑名单：/etc/modprobe.d/pve-blacklist.conf")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "blacklist snd_hda_intel" >> /etc/modprobe.d/pve-blacklist.conf\n\necho "blacklist snd_hda_codec_hdmi" >> /etc/modprobe.d/pve-blacklist.conf\n\necho "blacklist i915" >> /etc/modprobe.d/pve-blacklist.conf\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("p",[s._v("改好结果：")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/9.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_4-查看gpu的id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-查看gpu的id"}},[s._v("#")]),s._v(" 4.查看GPU的ID：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("lspci -nn | grep VGA\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("比如我的：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("00:02.0 VGA compatible controller [0300]: Intel Corporation HD Graphics [8086:1606] (rev 08)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/10.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("8086:1606 就是核显的ID")])]),s._v(" "),e("li",[e("p",[s._v("00:02.0 是核显的编号")])])]),s._v(" "),e("p",[s._v("接着执行：(ids=xxxx:xxxx，xxxx:xxxx替换成你获取的ID)")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "options vfio-pci ids=8086:1606" >> /etc/modprobe.d/vfio.conf\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_5-如果要音频直通-就搜索音频设备的id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-如果要音频直通-就搜索音频设备的id"}},[s._v("#")]),s._v(" 5.如果要音频直通，就搜索音频设备的ID")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("lspci -nn | grep Audio\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("比如我的：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("00:03.0 Audio device [0403]: Intel Corporation Broadwell-U Audio Controller [8086:160c] (rev 08)\n00:1b.0 Audio device [0403]: Intel Corporation Wildcat Point-LP High Definition Audio Controller [8086:9ca0] (rev 03)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/11.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("8086:160c/8086:9ca0  就是音频设备ID (一个是板载，一个是单独的音频孔，所以是2个)")])]),s._v(" "),e("li",[e("p",[s._v("00:03.0/00:1b.0 是音频设备编号")])])]),s._v(" "),e("p",[s._v("接着执行：(ids=xxxx:xxxx，xxxx:xxxx替换成你获取的GPU/音频设备ID，用英文逗号隔开)")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "options vfio-pci ids=8086:1606,8086:160c,8086:9ca0" >> /etc/modprobe.d/vfio.conf\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_6-更新内核并重启"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-更新内核并重启"}},[s._v("#")]),s._v(" 6.更新内核并重启：")]),s._v(" "),e("p",[s._v("执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("update-initramfs -u\n\nreboot\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_7-验证是否开启iommu"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-验证是否开启iommu"}},[s._v("#")]),s._v(" 7.验证是否开启iommu：")]),s._v(" "),e("p",[s._v("终端输入：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("dmesg | grep 'remapping'\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("要出现：DMAR-IR: Enabled IRQ remapping in x2apic mode")]),s._v(" "),e("p",[s._v("接着用下面的命令：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("find /sys/kernel/iommu_groups/ -type l  \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("出现很多数据，每一行最后的xx:xx.x是设备编号，查看要直通的设备的编号是否在里面。")]),s._v(" "),e("h4",{attrs:{id:"_8-添加pci设备即可-我只添加核显-音频设备看设备编号按需添加"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-添加pci设备即可-我只添加核显-音频设备看设备编号按需添加"}},[s._v("#")]),s._v(" 8.添加PCI设备即可：(我只添加核显，音频设备看设备编号按需添加)")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/12.jpg",alt:"jpg"}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/13.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_9-验证核显直通成功没"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_9-验证核显直通成功没"}},[s._v("#")]),s._v(" 9.验证核显直通成功没？")]),s._v(" "),e("ul",[e("li",[s._v("在直通后的系统的终端执行：")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ls /dev/dri\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("输出如图，出现“renderD128”就成功了：")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/21.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"黑群晖7-x人脸识别-ds918"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#黑群晖7-x人脸识别-ds918"}},[s._v("#")]),s._v(" 黑群晖7.x人脸识别(DS918+)")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-已经按照上面的步骤-核显直通黑裙7"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-已经按照上面的步骤-核显直通黑裙7"}},[s._v("#")]),s._v(" 1.已经按照上面的步骤，核显直通黑裙7；")]),s._v(" "),e("h4",{attrs:{id:"_2-编辑-etc-pve-qemu-server-102-conf-文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-编辑-etc-pve-qemu-server-102-conf-文件"}},[s._v("#")]),s._v(' 2.编辑"/etc/pve/qemu-server/102.conf"文件：')]),s._v(" "),e("ul",[e("li",[s._v("为啥是102.conf，因为演示的黑裙7的虚拟机ID是102，根据你自己的来。")])]),s._v(" "),e("p",[s._v("显卡hostpci0: 这一行的最后，添加：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(",legacy-igd=1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/22.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-回到pve管理界面-更改黑裙7的硬件-显示为无-然后重启黑裙7。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-回到pve管理界面-更改黑裙7的硬件-显示为无-然后重启黑裙7。"}},[s._v("#")]),s._v(" 3.回到PVE管理界面，更改黑裙7的硬件——显示为无，然后重启黑裙7。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/23.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_4-然后等待photos索引-就能看到人脸已经识别了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-然后等待photos索引-就能看到人脸已经识别了。"}},[s._v("#")]),s._v(" 4.然后等待Photos索引，就能看到人脸已经识别了。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/24.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"gvt-g直通-intel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gvt-g直通-intel"}},[s._v("#")]),s._v(" GVT-G直通(intel)")]),s._v(" "),e("p",[e("strong",[s._v("此方式适合桌面级别的U(差不多5代起步)，小主机(J4125/N5105等)不支持！！！")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("这种直通和上面的直通方法，二选一，不能同时选2种！！！")])]),s._v(" "),e("li",[e("p",[s._v("好处是显卡拆成好多个分别给不同虚拟机使用。")])])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-首先在主板bios里面启用gtd-gtx等选项-若有aperture-size选项-建议512m-没有就不管吧"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-首先在主板bios里面启用gtd-gtx等选项-若有aperture-size选项-建议512m-没有就不管吧"}},[s._v("#")]),s._v(" 1.首先在主板BIOS里面启用GTD，GTX等选项，若有aperture size选项，建议512M，没有就不管吧；")]),s._v(" "),e("h4",{attrs:{id:"_2-编辑grub配置文件-etc-default-grub"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-编辑grub配置文件-etc-default-grub"}},[s._v("#")]),s._v(" 2.编辑GRUB配置文件：/etc/default/grub")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('sed -i "s/quiet/quiet intel_iommu=on i915.enable_gvt=1/g" /etc/default/grub\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("然后执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("update-grub\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3-添加所需的系统模块-驱动-etc-modules"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-添加所需的系统模块-驱动-etc-modules"}},[s._v("#")]),s._v(" 3.添加所需的系统模块(驱动)：/etc/modules")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "vfio" >> /etc/modules\n\necho "vfio_iommu_type1" >> /etc/modules\n\necho "vfio_pci" >> /etc/modules\n\necho "vfio_virqfd" >> /etc/modules\n\necho "kvmgt" >> /etc/modules\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h4",{attrs:{id:"_4-更新内核并重启"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-更新内核并重启"}},[s._v("#")]),s._v(" 4.更新内核并重启：")]),s._v(" "),e("p",[s._v("执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("update-initramfs -u\n\nreboot\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("h4",{attrs:{id:"_5-验证是否开启gvt"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-验证是否开启gvt"}},[s._v("#")]),s._v(" 5.验证是否开启GVT：")]),s._v(" "),e("p",[s._v("0000:00:02.0  将00:02.0换成自己的GPU的编号 (lspci -nn | grep VGA 查看，最前面的就是)")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ls /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("出现如下即为成功(教程机核显为UHD630)：")]),s._v(" "),e("p",[s._v("i915-GVTg_V5_4 i915-GVTg_V5_8")]),s._v(" "),e("h4",{attrs:{id:"_6-配置直通"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-配置直通"}},[s._v("#")]),s._v(" 6.配置直通：")]),s._v(" "),e("p",[s._v('cpu类型设置成HOST，将机器设置成q35，将虚拟机显卡设置成无，添加PCIE设备：勾选高级里的ROM-Bar和PCI-E，主GPU不勾选，MDev类型选择合适"显卡"。')]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/20.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("“可用”显示的多少，就可以添加多个“显卡”。")])]),s._v(" "),e("p",[s._v("比如上图就是说：只能添加1个v5_4的“显卡”或者添加2个v5_8的“显卡”，只能用一种类型的显卡。")])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"gvt-g改显存-增加-显卡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gvt-g改显存-增加-显卡"}},[s._v("#")]),s._v(' GVT-G改显存，增加"显卡"')]),s._v(" "),e("p",[e("strong",[s._v("承接上一个GVT-G直通教程。")])]),s._v(" "),e("p",[e("strong",[s._v("此教程有风险，请知悉，若操作，请自行承担风险。")])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"为了分配更多显卡-需给核显分配更多显存。但一般主板的bios并没有给调节显存的选项-aperture-size-只给了类似dvmt-共享显存-选项-最大1024mb-当把dvmt改成1024mb后-并没有用。所以本教程强行改aperture-size。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为了分配更多显卡-需给核显分配更多显存。但一般主板的bios并没有给调节显存的选项-aperture-size-只给了类似dvmt-共享显存-选项-最大1024mb-当把dvmt改成1024mb后-并没有用。所以本教程强行改aperture-size。"}},[s._v("#")]),s._v(' 为了分配更多显卡，需给核显分配更多显存。但一般主板的BIOS并没有给调节显存的选项"aperture size"，只给了类似DVMT(共享显存)选项，最大1024MB，当把DVMT改成1024MB后，并没有用。所以本教程强行改aperture size。')]),s._v(" "),e("p",[s._v("通过命令 "),e("code",[s._v("lspci -vs 00:02.0")]),s._v(" 查看，一般默认是256M。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/1.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("128M的显卡只有一个，所以需要改大到512M。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/20.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_1-自行去主板官网下载当前主板的bios-注意版本-然后下载教程提供的工具包。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-自行去主板官网下载当前主板的bios-注意版本-然后下载教程提供的工具包。"}},[s._v("#")]),s._v(" 1.自行去主板官网下载当前主板的BIOS(注意版本)，然后下载教程提供的工具包。")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/%E6%94%B9GVT%E5%B7%A5%E5%85%B7%E5%8C%85.zip",target:"_blank",rel:"noopener noreferrer"}},[s._v("工具包下载地址"),e("OutboundLink")],1)]),s._v(" "),e("h4",{attrs:{id:"_2-使用工具包里的uefitool0270工具-打开bios文件-提取模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用工具包里的uefitool0270工具-打开bios文件-提取模块"}},[s._v("#")]),s._v(" 2.使用工具包里的UEFITool0270工具，打开BIOS文件，提取模块；")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/2.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("按Ctrl+F打开搜索页面，切换到text选项卡，搜索aperture size：")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/3.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("点击搜索出来的结果，会跳转到对应模块位置；")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/4.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("然后导出模块，并另存为。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/5.jpg",alt:"jpg"}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/6.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-使用工具包里的irfextractor-exe打开另存为的文件-找偏移量。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用工具包里的irfextractor-exe打开另存为的文件-找偏移量。"}},[s._v("#")]),s._v(" 3.使用工具包里的IRFExtractor.exe打开另存为的文件，找偏移量。")]),s._v(" "),e("ul",[e("li",[s._v("打开，并解析出文本，另存为。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/7.jpg",alt:"jpg"}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/8.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("打开解析文本，搜索aperture size，红框内的 "),e("code",[s._v("0x2E8")]),s._v(" 就是我们要找的偏移量。每个主板的BIOS偏移量不一样。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/9.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[s._v("通过图可以看出，默认是0x1，也就是256M。若要改512M，就得默认0x3，改1G，就得默认0x7。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/10.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_4-准备一个u盘-格式化为fat32-然后把工具包内的efi文件夹放u盘根目录-然后电脑重启进u盘引导。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-准备一个u盘-格式化为fat32-然后把工具包内的efi文件夹放u盘根目录-然后电脑重启进u盘引导。"}},[s._v("#")]),s._v(" 4.准备一个U盘，格式化为FAT32，然后把工具包内的EFI文件夹放U盘根目录，然后电脑重启进U盘引导。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/11.jpg",alt:"jpg"}})]),s._v(" "),e("ul",[e("li",[e("p",[s._v("U盘引导进入grub命令行模式，直接输入命令："),e("code",[s._v("setup_var 0x2E8 0x3")]),s._v(" ，意思就是把aperture size的偏移量默认改成0x3，也就是aperture size为512M。")])]),s._v(" "),e("li",[e("p",[s._v("建议只改512M，经验告诉我们改1G，可能会出问题。")])])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/12.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_5-改完成功后-开机pve-就会看到-显卡-多了很多。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-改完成功后-开机pve-就会看到-显卡-多了很多。"}},[s._v("#")]),s._v(' 5.改完成功后，开机PVE，就会看到"显卡"多了很多。')]),s._v(" "),e("p",[s._v("通过命令 "),e("code",[s._v("lspci -vs 00:02.0")]),s._v(" 查看，已经变成512M。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/16.jpg",alt:"jpg"}})]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/13.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"gvt-g黑群辉核显直通-人脸"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gvt-g黑群辉核显直通-人脸"}},[s._v("#")]),s._v(" GVT-G黑群辉核显直通+人脸")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-先把群辉虚拟机关机-然后硬件-显示-设为无-然后修改虚拟机配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-先把群辉虚拟机关机-然后硬件-显示-设为无-然后修改虚拟机配置文件"}},[s._v("#")]),s._v(" 1.先把群辉虚拟机关机，然后硬件——显示，设为无； 然后修改虚拟机配置文件；")]),s._v(" "),e("p",[s._v("/etc/pve/qemu-server/102.conf (教程演示群辉虚拟机ID是102，所以是102.conf)")]),s._v(" "),e("p",[s._v("在配置文件第一行写入以下代码：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("args: -device vfio-pci,sysfsdev=/sys/bus/mdev/devices/604e42e4-2e90-11ec-8861-037c58d42915,addr=02.0,x-igd-opregion=on,driver=vfio-pci-nohotplug\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/14.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_2-然后pve终端-运行命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-然后pve终端-运行命令"}},[s._v("#")]),s._v(" 2.然后PVE终端，运行命令：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("mkdir /var/lib/vz/snippets\n\ncp /usr/share/pve-docs/examples/guest-example-hookscript.pl /var/lib/vz/snippets/102-autocreate.pl\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("尾部的102和虚拟机ID对应；然后修改/var/lib/vz/snippets/102-autocreate.pl，在如图位置添加下列2行代码：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('system("echo 604e42e4-2e90-11ec-8861-037c58d42915 > /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/i915-GVTg_V5_4/create");\n\n上一行代码中的i915-GVTg_V5_4，取决于你要什么类型的显卡，V5_2/8都行。\n\n\nsystem("echo 1 > /sys/bus/mdev/devices/604e42e4-2e90-11ec-8861-037c58d42915/remove");\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/gvt/15.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-最后终端执行-qm-set-102-hookscript-local-snippets-102-autocreate-pl-102和虚拟机id对应"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-最后终端执行-qm-set-102-hookscript-local-snippets-102-autocreate-pl-102和虚拟机id对应"}},[s._v("#")]),s._v(" 3.最后终端执行："),e("code",[s._v("qm set 102 --hookscript local:snippets/102-autocreate.pl")]),s._v(" (102和虚拟机ID对应)")]),s._v(" "),e("h4",{attrs:{id:"_4-群辉开机-核显已经直通-且photo人脸ok。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-群辉开机-核显已经直通-且photo人脸ok。"}},[s._v("#")]),s._v(" 4.群辉开机，核显已经直通，且photo人脸ok。")])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"直通硬盘-全盘映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#直通硬盘-全盘映射"}},[s._v("#")]),s._v(" 直通硬盘(全盘映射)")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"上面说了核显直通-接着说硬盘直通。前面步骤完成了-现在很简单了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#上面说了核显直通-接着说硬盘直通。前面步骤完成了-现在很简单了。"}},[s._v("#")]),s._v(" 上面说了核显直通，接着说硬盘直通。前面步骤完成了，现在很简单了。")]),s._v(" "),e("h4",{attrs:{id:"_1-查看读取存储设备序列号"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看读取存储设备序列号"}},[s._v("#")]),s._v(" 1.查看读取存储设备序列号：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("ls /dev/disk/by-id\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/18.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("找出自己的硬盘序列号。比如我的就是：")]),s._v(" "),e("p",[s._v("ata-ST1000XXXXXXXXXXXXXXX")]),s._v(" "),e("h4",{attrs:{id:"_2-执行命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-执行命令"}},[s._v("#")]),s._v(" 2.执行命令：")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("102：改成自己要直通硬盘的的虚拟机ID。")])]),s._v(" "),e("li",[e("p",[s._v("sata1：已有sata0，所以往后排，为sata1，按需修改。")])])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("qm set 102 -sata1 /dev/disk/by-id/ata-ST1000XXXXXXXXXXXXXXX\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("返回下面信息就说明成功挂载：")]),s._v(" "),e("p",[s._v("update VM 102: -sata1 /dev/disk/by-id/ata-ST1000XXXXXXXXXXXXXXX")]),s._v(" "),e("h4",{attrs:{id:"_3-返回pve查看-已经挂载-重启即可完成。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-返回pve查看-已经挂载-重启即可完成。"}},[s._v("#")]),s._v(" 3.返回PVE查看，已经挂载，重启即可完成。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/19.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"pve-直接安装docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pve-直接安装docker"}},[s._v("#")]),s._v(" PVE 直接安装Docker")]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-登录pve的ssh-输入以下命令-安装docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-登录pve的ssh-输入以下命令-安装docker"}},[s._v("#")]),s._v(" 1.登录PVE的SSH，输入以下命令，安装Docker：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("curl -sSL https://get.docker.com/ | sh\n\nchmod 777 /var/run/docker.sock\n\nsystemctl start docker\n\nsystemctl enable docker.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("上面的命令一条一条执行完毕后，docker就安装好了。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/14.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_2-接着终端继续输入命令-安装portainer-ce汉化版"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-接着终端继续输入命令-安装portainer-ce汉化版"}},[s._v("#")]),s._v(" 2.接着终端继续输入命令，安装Portainer-CE汉化版：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('docker run -d --restart=always --name="portainer" -p 9000:9000 -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data 6053537/portainer-ce\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3-等待上述安装命令执行完毕-然后打开pve的ip地址-9000端口-进入portainer-ce。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-等待上述安装命令执行完毕-然后打开pve的ip地址-9000端口-进入portainer-ce。"}},[s._v("#")]),s._v(" 3.等待上述安装命令执行完毕，然后打开PVE的IP地址+9000端口，进入Portainer-CE。")]),s._v(" "),e("p",[s._v("ps：例如我的pve的ip是192.168.100.1，那么就是进入http://192.168.100.1:9000。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/17.jpg",alt:"jpg"}})])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"配置pve的性能-省电模式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置pve的性能-省电模式"}},[s._v("#")]),s._v(" 配置PVE的性能/省电模式")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("常理来说Linux的系统CPU模式是性能模式，而PVE是基于debian的系统，所以PVE默认的也是性能模式。")])]),s._v(" "),e("li",[e("p",[s._v("可能有些小伙伴的PVE主机性能很强，功耗也高，可以通过设置成省电模式，来降低功耗。")])]),s._v(" "),e("li",[e("p",[s._v("具体能降低多少，请自测。")])])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_1-当前pve主机是否支持多种模式切换-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-当前pve主机是否支持多种模式切换-终端执行"}},[s._v("#")]),s._v(" 1.当前PVE主机是否支持多种模式切换，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_available_governors\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/48.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("能返回 "),e("code",[s._v("performance")]),s._v(" (性能模式) 和 "),e("code",[s._v("powersave")]),s._v(" (省电模式)等，就接着往下看，如果只有 "),e("code",[s._v("performance")]),s._v(" 就关闭这个教程。")]),s._v(" "),e("ul",[e("li",[s._v("有些机器CPU比较新，可能还有conservative、schedutil、ondemand等，都可以切换。")])]),s._v(" "),e("h4",{attrs:{id:"_2-安装cpupower-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装cpupower-终端执行"}},[s._v("#")]),s._v(" 2.安装cpupower，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt-get install linux-cpupower -y\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/49.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_3-切换成省电模式-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-切换成省电模式-终端执行"}},[s._v("#")]),s._v(" 3.切换成省电模式，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cpupower -c all frequency-set -g powersave\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/50.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("有多少核，就会返回多少cpu。")]),s._v(" "),e("ul",[e("li",[s._v("如果想切换到其他模式：conservative、schedutil、ondemand等")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cpupower -c all frequency-set -g conservative\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cpupower -c all frequency-set -g schedutil\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("cpupower -c all frequency-set -g ondemand\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("ul",[e("li",[s._v("然后执行： "),e("code",[s._v("cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor")]),s._v(" ，查看当前CPU处于什么模式。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/51.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("可以看到已经切成"),e("code",[s._v("powersave")]),s._v("省电模式。")]),s._v(" "),e("ul",[e("li",[s._v("如果要切回性能模式，就执行： "),e("code",[s._v("cpupower -c all frequency-set -g performance")]),s._v(" 。")])])]),s._v(" "),e("hr"),s._v(" "),e("h3",{attrs:{id:"pve7-x升级第三方内核6-0"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pve7-x升级第三方内核6-0"}},[s._v("#")]),s._v(" PVE7.x升级第三方内核6.0")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("PVE7.x目前官方默认内核是5.15，找到个第三方的6.0内核，也可以玩玩。")])]),s._v(" "),e("li",[e("p",[s._v("仅适用于PVE 7.x，PVE6.x绕道。")])]),s._v(" "),e("li",[e("p",[s._v("仅适用于动手能力强的，小白绕道!")])]),s._v(" "),e("li",[e("p",[s._v("升级内核可能有翻车的风险，风险自行承担！")])])]),s._v(" "),e("details",[e("summary",[s._v("点击展开，查看详细教程！")]),s._v(" "),e("h4",{attrs:{id:"_0-升级6-0内核之前-请先牢记当前pve的内核版本号-后面回退要用。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_0-升级6-0内核之前-请先牢记当前pve的内核版本号-后面回退要用。"}},[s._v("#")]),s._v(" 0.升级6.0内核之前，请先牢记当前pve的内核版本号，后面回退要用。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/54.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("如图所示，当前内核版本号就为：5.15.64-1-pve")]),s._v(" "),e("h4",{attrs:{id:"_1-添加存储库的gpg密钥-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-添加存储库的gpg密钥-终端执行"}},[s._v("#")]),s._v(" 1.添加存储库的GPG密钥，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("curl -1sLf 'https://dl.cloudsmith.io/public/pve-edge/kernel/gpg.8EC01CCF309B98E7.key' | gpg --dearmor -o /usr/share/keyrings/pve-edge-kernel.gpg\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_2-设置pve-edge-kernel存储库-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-设置pve-edge-kernel存储库-终端执行"}},[s._v("#")]),s._v(" 2.设置pve-edge-kernel存储库，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('echo "deb [signed-by=/usr/share/keyrings/pve-edge-kernel.gpg] https://dl.cloudsmith.io/public/pve-edge/kernel/deb/debian bullseye main" > /etc/apt/sources.list.d/pve-edge-kernel.list\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3-安装内核-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装内核-终端执行"}},[s._v("#")]),s._v(" 3.安装内核，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt update\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("apt install pve-kernel-6.0-edge\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_4-重启以后-内核就升级到6-0了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-重启以后-内核就升级到6-0了。"}},[s._v("#")]),s._v(" 4.重启以后，内核就升级到6.0了。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/52.jpg",alt:"jpg"}})]),s._v(" "),e("h4",{attrs:{id:"_5-查看内核更新没-可去下面的网址看看-若有新版-重复第三步的操作。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-查看内核更新没-可去下面的网址看看-若有新版-重复第三步的操作。"}},[s._v("#")]),s._v(" 5.查看内核更新没，可去下面的网址看看，若有新版，重复第三步的操作。")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/fabianishere/pve-edge-kernel/releases",target:"_blank",rel:"noopener noreferrer"}},[s._v("查看内核更新"),e("OutboundLink")],1)]),s._v(" "),e("h4",{attrs:{id:"_6-已经升级到第三方内核-如果你在wed界面-更新-看到更新-就不要胡乱更新了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-已经升级到第三方内核-如果你在wed界面-更新-看到更新-就不要胡乱更新了。"}},[s._v("#")]),s._v(" 6.已经升级到第三方内核，如果你在wed界面“更新”，看到更新，就不要胡乱更新了。")]),s._v(" "),e("h4",{attrs:{id:"_7-如果需要回退内核-利用proxmox-boot-tool回退-终端执行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-如果需要回退内核-利用proxmox-boot-tool回退-终端执行"}},[s._v("#")]),s._v(" 7.如果需要回退内核，利用proxmox-boot-tool回退，终端执行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("proxmox-boot-tool kernel pin 升级前的内核版本号\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("升级前我的内核版本号是：5.15.64-1-pve，所以命令如下：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("proxmox-boot-tool kernel pin 5.15.64-1-pve\n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("proxmox-boot-tool refresh\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_8-执行完第7步的两条命令后-系统重启-内核就回退了。"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_8-执行完第7步的两条命令后-系统重启-内核就回退了。"}},[s._v("#")]),s._v(" 8.执行完第7步的两条命令后，系统重启，内核就回退了。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://raw.githubusercontent.com/xiangfeidexiaohuo/ProxmoxVE-7.0-DIY/master/pic/53.jpg",alt:"jpg"}})]),s._v(" "),e("p",[s._v("然后看到内核切回了，然后终端运行：")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("rm -rf /etc/default/grub.d/proxmox-kernel-pin.cfg\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("以后就能正常使用“升级”来更新PVE。")])])])}),[],!1,null,null,null);e.default=r.exports}}]);