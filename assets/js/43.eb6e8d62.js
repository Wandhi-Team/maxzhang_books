(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{366:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("当我们想在某个Nginx网站中增加一个两级目录（当然也可以是很多级）作为反向代理时")]),s._v(" "),a("p",[s._v("如果使用常见的单个Nginx反向代理配置的方法，非常容易遇到配置有问题的情况。")]),s._v(" "),a("p",[s._v("主要由如下两个问题造成：")]),s._v(" "),a("ul",[a("li",[s._v("1、因为不是独立配置反向代理，所以Nginx Config 文件中，已经有类似 rewrite、.js .css 等、PHP解析器等等的路由规则在，所以你增加的二级反向代理，非常有可能因为优先级不够，没有生效。")])]),s._v(" "),a("blockquote",[a("p",[s._v("所以建议学习一下正则匹配的优先级；")])]),s._v(" "),a("ul",[a("li",[s._v("2、由于 proxy_pass 的一个小细节导致路径不正确，测试时始终不能达到预期的效果，总是出现404的情况，因为在独立配置时，倒不会出现这样的情况。关键点在于 URL 的结尾要不要以 “/” 结尾")])]),s._v(" "),a("blockquote",[a("p",[s._v("所以建议学习一下结尾"),a("strong",[s._v("要不要")]),s._v("使用斜杠的差别。")])]),s._v(" "),a("h1",{attrs:{id:"提高优先级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提高优先级"}},[s._v("#")]),s._v(" 提高优先级")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("location ^~ /proxyname "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      proxy_pass https://youdomain.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("blockquote",[a("p",[a("code",[s._v("^~")]),s._v("代表了高优先级的规则")])]),s._v(" "),a("h1",{attrs:{id:"斜杠路径的区分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#斜杠路径的区分"}},[s._v("#")]),s._v(" 斜杠路径的区分")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("location ^~ /proxyname "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      proxy_pass https://youdomain.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("以上规则下，当你访问 "),a("code",[s._v("/proxyname/exp")]),s._v("时")]),s._v(" "),a("p",[s._v("会被反代到 "),a("code",[s._v("https://youdomain.com/proxyname/exp")]),s._v("下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("location ^~ /proxyname "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      proxy_pass https://youdomain.com/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("以上规则下，当你访问 "),a("code",[s._v("/proxyname/exp")]),s._v("时")]),s._v(" "),a("p",[s._v("则会被反代到 "),a("code",[s._v("https://youdomain.com/exp")]),s._v("下")])])}),[],!1,null,null,null);a.default=e.exports}}]);